{% load static %}
{% load dict_extras %}
<!-- Breadcumb Section Start -->
<div class="breadcrumb-wrapper">
    <div class="book1">
        <img src="{% static 'assets/img/hero/book1.png' %}" alt="book">
    </div>
    <div class="book2">
        <img src="{% static 'assets/img/hero/book2.png' %}" alt="book">
    </div>
    <div class="container">
        <div class="page-heading">
            <h1>Shop {{business_name}}</h1>
            <div class="page-header">
                <ul class="breadcrumb-items wow fadeInUp" data-wow-delay=".3s">
                    <li>
                        <a href="{% url 'store:home' %}">
                            Home
                        </a>
                    </li>
                    <li>
                        <i class="fa-solid fa-chevron-right"></i>
                    </li>
                    <li>
                        {{business_name}}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Shop Section Start -->
<section class="shop-section fix section-padding">
    <div class="container">
        <div class="shop-default-wrapper">
            <div class="row">
                <div class="col-12">
                    <div class="woocommerce-notices-wrapper wow fadeInUp" data-wow-delay=".3s">
                        <p>Showing {{ results_range.first }}â€“{{ results_range.last }} of {{ results_range.total }} Results </p>
                        <div class="form-clt">
                            <div class="nice-select" tabindex="0">
                                <span class="current">
                                    Default Sorting
                                </span>
                                <ul class="list">
                                    <li data-value="1" class="option selected focus">
                                        Default sorting
                                    </li>
                                    <li data-value="1" class="option">
                                        Sort by popularity
                                    </li>
                                    <li data-value="1" class="option">
                                        Sort by average rating
                                    </li>
                                    <li data-value="1" class="option">
                                        Sort by latest
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 order-2 order-md-1 wow fadeInUp" data-wow-delay=".3s">
                    <div class="main-sidebar">
                        <div class="single-sidebar-widget">
                            <div class="wid-title">
                                <h5>Search</h5>
                            </div>
                            <form action="{% url 'store:shop' %}"  method="get" class="search-toggle-box">
                                <div class="input-area search-container">
                                    <input class="search-input" name="search" value="{{ search|default:'' }}" type="text" placeholder="Search here">
                                    <button class="cmn-btn search-icon">
                                        <i class="far fa-search"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="single-sidebar-widget">
                            <div class="wid-title">
                                <h5>Categories</h5>
                            </div>
                            <div class="categories-list">
                                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">

                                    {% for cat in categories %}
                                        <li class="nav-item" role="presentation">
                                        <a class="nav-link {% if cat.slug in selected_categories %}active{% endif %}"
                                            href="?categories={{ cat.slug }}{% if qs_no_categories %}&{{ qs_no_categories }}{% endif %}">
                                            {{ cat.name }} ({{ cat.product_count }})
                                        </a>
                                        </li>
                                    {% empty %}
                                        <li class="nav-item"><span class="nav-link disabled">No categories</span></li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <div class="single-sidebar-widget">
                            <div class="wid-title">
                                <h5>Product Status</h5>
                            </div>
                            <div class="product-status">
                                <div class="product-status_stock  gap-6 d-flex align-items-center">
                                    <div class="nice-select category" tabindex="0"><span class="current">
                                            Stock Status
                                        </span>
                                        <ul class="list">
                                            <a href="?stock_status=in_stock{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    In Stock
                                                </li>
                                            </a>
                                            <a href="?stock_status=pre_order{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Pre-Order
                                                </li>
                                            </a>
                                            <a href="?stock_status=backorder{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Backorder
                                                </li>
                                            </a>
                                            <a href="?stock_status=out_of_stock{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Out of Stock
                                                </li>
                                            </a>
                                            <a href="?stock_status=out_of_print{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Out of Print
                                                </li>
                                            </a>
                                            <a href="?stock_status=print_on_demand{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Print on Demand
                                                </li>
                                            </a>
                                            <a href="?stock_status=available{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Available
                                                </li>
                                            </a>
                                            <a href="?stock_status=unavailable{% if qs_no_stock %}&{{ qs_no_stock }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Unavailable
                                                </li>
                                            </a>
                                        </ul>
                                    </div>
                                </div>
                                <div class="product-status_sale gap-6 d-flex align-items-center">
                                    <div class="nice-select category" tabindex="0">
                                        <span class="current">
                                            Format Type
                                        </span>
                                        <ul class="list">
                                            <a href="?format_type=both{% if qs_no_format %}&{{ qs_no_format }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    Both
                                                </li>
                                            </a>
                                            <a href="?format_type=physical{% if qs_no_format %}&{{ qs_no_format }}{% endif %}">
                                                <li data-value="1" class="option selected">
                                                    Physical
                                                </li>
                                            </a>
                                            <a href="?format_type=ebook{% if qs_no_format %}&{{ qs_no_format }}{% endif %}">
                                                <li data-value="1" class="option">
                                                    E-Book
                                                </li>
                                            </a>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="single-sidebar-widget mb-50">
                            <div class="wid-title">
                                <h5>Filter By Price</h5>
                            </div>
                            <form method="get" action="{% url 'store:shop' %}">
                                <div class="range__barcustom">
                                    <div class="slider">
                                        <div class="progress" style="left: 15.29%; right: 58.9%;"></div>
                                    </div>
                                    <div class="range-input">
                                        <input type="range" class="range-min" name="min_price" min="0" max="300000" value="2500">
                                        <input type="range" class="range-max" name="max_price" min="100" max="300000" value="50000">
                                    </div>
                                    <div class="range-items">
                                        <div class="price-input">
                                            <div class="d-flex align-items-center">
                                                <button type="submit" class="filter-btn mt-2 me-3">Filter</button>
                                                <div class="field">
                                                    <span>Price:</span>
                                                </div>
                                                <div class="field">
                                                    <span>â‚¦</span>
                                                    <input type="number" class="input-min" value="2500">
                                                </div>
                                                <div class="separators">-</div>
                                                <div class="field">
                                                    <span>â‚¦</span>
                                                    <input type="number" class="input-max" value="50000">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="single-sidebar-widget mb-0">
                            <div class="wid-title">
                                <h5>By Review</h5>
                            </div>
                            <div class="categories-list">
                                <form method="get" id="filter-form">
                                {% for rating in "5 4 3 2 1"|split:" " %}
                                    <label class="checkbox-single d-flex align-items-center">
                                        <span class="d-flex gap-xl-3 gap-2 align-items-center">
                                            <span class="checkbox-area d-center">
                                                <input type="radio" name="rating" value="{{ rating }}"
                                                {% if selected_rating|stringformat:"s" == rating %}checked{% endif %}
                                                onchange="this.form.submit()">
                                                <span class="checkmark d-center"></span>
                                            </span>
                                            <span class="text-color">
                                                <span class="star">
                                                    {% include "rating_star/"|add:rating|add:"_star.html" %}
                                                </span>
                                                {{ ratings_data|dict_get:rating|default:"0" }}

                                            </span>
                                        </span>
                                    </label>
                                {% endfor %}
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="col-xl-9 col-lg-8 order-1 order-md-2">
                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-arts" role="tabpanel"
                            aria-labelledby="pills-arts-tab" tabindex="0">
                            <div class="row">
                                {% for product in products %}
                                <div class="col-xl-3 col-lg-4 col-md-6 wow fadeInUp" data-wow-delay=".2s">
                                    <div class="shop-box-items">
                                        <div class="book-thumb center">
                                            <a href="{% url 'store:product_detail' product.slug %}"><img src="{{ product.main_image }}" alt="img"></a>
                                            <ul class="post-box">
                                                <li>
                                                    Hot
                                                </li>
                                            </ul>
                                            <ul class="shop-icon d-grid justify-content-center align-items-center">
                                                <li>
                                                    <a href="shop-cart.html"><i class="far fa-heart"></i></a>
                                                </li>
                                                <li>
                                                    <a href="shop-cart.html">
                                                        <img class="icon" src="{% static 'assets/img/icon/shuffle.svg' %}"
                                                            alt="svg-icon">
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'store:product_detail' product.slug %}"><i class="far fa-eye"></i></a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="shop-content">
                                            <h3><a href="{% url 'store:product_detail' product.slug %}">{{product.title|truncatewords:4}}</a></h3>
                                            <ul class="price-list">
                                                <li>â‚¦{{product.price}}</li>
                                                <li>
                                                    <i class="fa-solid fa-star"></i>
                                                    {{product.average_rating}} ({{product.rating_count}})
                                                </li>
                                            </ul>
                                            <div class="shop-button">
                                                <a href="shop-details.html" class="theme-btn"><i
                                                        class="fa-solid fa-basket-shopping"></i> Add To Cart</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% empty %}
                                    <p>No products found.</p>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="page-nav-wrap text-center">
                        <ul>
                            {% if has_prev %}
                                <li>
                                    <a class="previous" href="?page={{ prev_page }}{% if qs %}&{{ qs }}{% endif %}">Previous</a>
                                </li>
                            {% endif %}

                            {% for p in page_numbers %}
                                <li>
                                    <a class="page-numbers {% if p == page %}active{% endif %}"
                                        href="?page={{ p }}{% if qs %}&{{ qs }}{% endif %}">{{ p }}</a>
                                </li>
                            {% endfor %}

                            {% if show_ellipsis %}
                                <li><span class="page-numbers">...</span></li>
                            {% endif %}

                            {% if has_next %}
                                <li>
                                    <a class="next" href="?page={{ next_page }}{% if qs %}&{{ qs }}{% endif %}">Next</a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>